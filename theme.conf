# vim: set ft=tmux:

# Catppuccin config
set-option -g status-position top
set -g @catppuccin_flavor 'mocha'

# Menu and pane settings
set -g @catppuccin_menu_selected_style "fg=#{@thm_surface_0},bg=#{@thm_green}"
set -g @catppuccin_pane_status_enabled "no"
set -g @catppuccin_pane_status_style "custom"
set -g @catppuccin_pane_left_separator " "
set -g @catppuccin_pane_middle_separator ""
set -g @catppuccin_pane_right_separator ""
set -g @catppuccin_pane_default_fill "number"
set -g @catppuccin_pane_border_status "off"
set -g @catppuccin_pane_border_style "fg=#{@thm_surface_0}"
set -g @catppuccin_pane_active_border_style "##{?pane_in_mode,fg=#{@thm_green},##{?pane_synchronized,fg=#{@thm_teal},fg=#{@thm_green}}}"

# Window settings
set -g @catppuccin_window_status_style "custom"
set -g @catppuccin_window_left_separator " "
set -g @catppuccin_window_middle_separator ""
set -g @catppuccin_window_number "#I "
set -g @catppuccin_window_text_color "#{@thm_base}"
set -g @catppuccin_window_number_color "#{@thm_overlay_1}"
set -g @catppuccin_window_number_position "left"
set -g @catppuccin_window_text "#T#[reverse]"
set -g @catppuccin_window_current_number "#I "
set -g @catppuccin_window_current_text_color "#{@thm_base}"
set -g @catppuccin_window_current_number_color "#{@thm_mauve}"
set -g @catppuccin_window_current_text "#T #{pane_current_path}#[reverse]"

# Status settings
set -g @catppuccin_status_background "none"
set -g @catppuccin_status_default "no"
set -g @catppuccin_status_connect_separator "yes"
set -g @catppuccin_status_fill "icon"
set -g @catppuccin_status_module_bg_color "#{@thm_surface_0}"
set -g @catppuccin_status_left_separator " "
set -g @catppuccin_status_middle_separator ""
set -g @catppuccin_status_right_separator "#[reverse]█#[noreverse]"

# Custom separators

set -g @custom_separator_left ""
set -g @custom_separator_middle ""
set -g @custom_separator_right ""

### Module specific config

# Session
set -g @catppuccin_session_icon " "

# Command
set -g @catppuccin_status_load_icon_bg "#{@thm_peach}"
set -g @catppuccin_status_load_text_bg "#{@thm_peach}"
set -g @catppuccin_status_load_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_load_text_fg "#{@thm_crust}"

# Online status
set -g @online_icon "ok"
set -g @offline_icon "nok"

# Primary IP
set -g @catppuccin_status_primary_ip_icon_bg "#{@thm_peach}"
set -g @catppuccin_status_primary_ip_text_bg "#{@thm_peach}"
set -g @catppuccin_status_primary_ip_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_primary_ip_text_fg "#{@thm_crust}"

# Gitmux
set -g @catppuccin_status_gitmux_text '#(gitmux -cfg ${HOME}/.gitmux.conf \"#{pane_current_path}\")'
if " ! command -v gitmux" "run 'go install github.com/arl/gitmux@latest'"
set -g @catppuccin_status_gitmux_icon_bg "#{@thm_surface_0}"
set -g @catppuccin_status_gitmux_text_bg "#{@thm_surface_0}"

# CPU and RAM settings
set -g @catppuccin_status_cpu_icon_bg "#{@thm_red}"
set -g @catppuccin_status_cpu_text_bg "#{@thm_red}"
set -g @catppuccin_status_cpu_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_cpu_text_fg "#{@thm_crust}"
set -g @catppuccin_status_ctp_memory_icon_bg "#{@thm_sky}"
set -g @catppuccin_status_ctp_memory_text_bg "#{@thm_sky}"
set -g @catppuccin_status_ctp_memory_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_ctp_memory_text_fg "#{@thm_crust}"

# Load settings
set -g @catppuccin_status_load_icon_bg "#{@thm_peach}"
set -g @catppuccin_status_load_text_bg "#{@thm_peach}"
set -g @catppuccin_status_load_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_load_text_fg "#{@thm_crust}"

# Weather settings
set -g @clima_ttl '10'
set -g @clima_unit 'metric'
set -g @clima_show_location 1
set -g @clima_location "Imperia"
set -g @clima_show_icon 1
set -g @clima_use_nerd_font 1
set -g @catppuccin_status_clima_icon "󰔐 "
set -g @catppuccin_status_clima_icon_bg "#{@thm_blue}"
set -g @catppuccin_status_clima_text_bg "#{@thm_blue}"
set -g @catppuccin_status_clima_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_clima_text_fg "#{@thm_crust}"
set -g @tmux-weather-format "%l:+%t+%c"
set -g @tmux-weather-units "m"
set -g @tmux-weather-location "Imperia"
set -g @catppuccin_weather_text "#{l:#{weather}}"
set -g @catppuccin_weather_icon_bg "#{@thm_blue}"
set -g @catppuccin_weather_text_bg "#{@thm_blue}"
set -g @catppuccin_weather_icon_fg "#{@thm_crust}"
set -g @catppuccin_weather_text_fg "#{@thm_crust}"

# Date and time settings
set -g @catppuccin_date_time_text " %Y-%m-%d %H:%M:%S"
set -g @catppuccin_status_date_time_icon_bg "#{@thm_lavender}"
set -g @catppuccin_status_date_time_text_bg "#{@thm_lavender}"
set -g @catppuccin_status_date_time_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_date_time_text_fg "#{@thm_crust}"

# Uptime and battery settings
set -g @catppuccin_status_uptime_icon_bg "#{@thm_maroon}"
set -g @catppuccin_status_uptime_text_bg "#{@thm_maroon}"
set -g @catppuccin_status_uptime_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_uptime_text_fg "#{@thm_crust}"
set -g @catppuccin_status_battery_icon_bg "#{@thm_rosewater}"
set -g @catppuccin_status_battery_text_bg "#{@thm_rosewater}"
set -g @catppuccin_status_battery_icon_fg "#{@thm_crust}"
set -g @catppuccin_status_battery_text_fg "#{@thm_crust}"

# Custom modules path
set-environment -gF TMUX_CUSTOM_MODULES_PATH '#{HOME}/.config/tmux/custom_modules'

# Load catppuccin and custom modules
run '#{TMUX_PLUGIN_MANAGER_PATH}/tmux/catppuccin.tmux'

# Load custom modules
source -F '#{TMUX_CUSTOM_MODULES_PATH}/command.conf'
source -F '#{TMUX_CUSTOM_MODULES_PATH}/online_status.conf'
source -F '#{TMUX_CUSTOM_MODULES_PATH}/primary_ip.conf'
source -F '#{TMUX_CUSTOM_MODULES_PATH}/ctp_cpu.conf'
source -F '#{TMUX_CUSTOM_MODULES_PATH}/ctp_memory.conf'

# Status line settings
set -g status-left-length 100
set -g status-left ""
set -gF status-left "#{E:@catppuccin_status_session}"
set -gaF status-left "#{E:@catppuccin_status_command}"
set -gaF status-left "#{E:@catppuccin_status_online_status}"
set -gaF status-left "#{E:@catppuccin_status_primary_ip}"

set -g status-right-length 100
set -g status-right ""
set -gF status-right "#{E:@catppuccin_status_gitmux}"
set -gaF status-right "#{E:@catppuccin_status_cpu}"
set -gaF status-right "#{E:@catppuccin_status_ctp_memory}"
set -gaF status-right "#{E:@catppuccin_status_clima}"
set -gaF status-right "#{E:@catppuccin_status_date_time}"
set -gaF status-right "#{E:@catppuccin_status_uptime}"
if 'test -r /sys/class/power_supply/BAT*' {
   set -gaF status-right "#{E:@catppuccin_status_battery}"
}
